# 🎮 序章丰富方案

## 📊 当前状态分析

### ✅ 已实现的内容
- 3个可互动物品：挂钟、旧行李、票据
- 陌生人对话系统（多轮分支对话）
- 列车到站完整演出
- 心率系统响应
- 基础灯光效果

### ⚠️ 未充分利用的系统
- **注视系统（GazeSystem）** - 只有TestClock在用
- **环境进度系统（EnvironmentProgressSystem）** - 完全未使用
- **黑暗事件管理器（DarknessEventManager）** - 只在票据触发
- **墙壁水渍/剥落效果** - 在文档中设计但未实现

---

## 🎯 丰富方案（3个优先级）

## 🔥 优先级1：立即可实现（1-2小时）

### 1.1 环境细节互动物品

基于文档设计，添加以下可互动物品：

#### **A. 墙上的褪色标语**
```gdscript
位置：墙壁上
效果：调查后发现"文明"二字缺失，只剩"讲__，树新风"
独白："连标语都在腐烂...这里到底被遗忘了多久？"
心率：+5
环境进度：+1
```

#### **B. 地面的积水**
```gdscript
位置：地面某处
效果：盯着积水看，发现倒映着闪烁的吊灯
独白："水面上的光...一闪一闪的，像是在提醒我什么。"
心率：+3
触发：灯光闪烁一次
```

#### **C. 破损的长椅**
```gdscript
位置：陌生人旁边的另一张长椅
效果：尝试坐下时，椅子发出刺耳的吱呀声
独白："坐下...休息一会儿？不，这里不是久留之地。"
心率：+5
音效：door_creak（刺耳吱呀声）
```

#### **D. 墙角的垃圾桶**
```gdscript
位置：角落
效果：调查发现里面有被撕碎的照片碎片
独白："有人...想抹去什么吗？还是说，这就是我的结局？"
心率：+8
环境进度：+1
```

---

### 1.2 注视系统扩展

让更多物体支持注视触发：

#### **陌生人注视效果**
```gdscript
当前：对话后才互动
改进：盯着陌生人看3秒 → 他缓慢抬头看向你
效果：
- 陌生人模型播放"抬头"动画
- 心率+15
- 播放低频嗡鸣音效
- 屏幕轻微扭曲
```

#### **挂钟注视效果**（已有TestClock，增强）
```gdscript
效果：盯着挂钟看3秒 → 指针突然逆转
效果：
- 播放时钟逆转音效
- 心率+12
- 短暂画面色差分离
```

#### **墙壁水渍注视**
```gdscript
添加一个墙壁水渍物体
效果：盯着水渍看3秒 → 水渍扩散成人脸形状
效果：
- 材质贴图动态变化（可用shader或动画）
- 心率+10
- 播放水滴声
```

---

### 1.3 环境渐变系统启用

基于探索进度，环境逐渐崩解：

```gdscript
# 在StoryManager中添加
func on_item_investigated():
    EnvironmentProgressSystem.on_item_investigated()

# 阶段效果：
阶段1（探索1-2个物品）：墙壁水渍开始扩散
阶段2（探索3-4个物品）：墙皮开始剥落
阶段3（探索5个物品）：天花板出现裂痕
阶段4（对话前）：裂痕开始发光（微弱红光）
阶段5（对话结束）：列车到站，一切崩塌
```

**实现：**
- 在场景中添加 WaterStain、WallPeel、Ceiling、CrackLight 节点
- 每个节点有对应的动画（透明度/材质变化）
- EnvironmentProgressSystem 自动触发

---

## ⭐ 优先级2：增强体验（3-5小时）

### 2.1 黑暗事件随机触发

在探索过程中随机触发恐怖事件：

#### **事件1：远处脚步声**
```gdscript
条件：玩家静止不动超过5秒
效果：
- 播放远处脚步声（渐近渐远）
- 心率+8
- 灯光轻微闪烁
```

#### **事件2：墙内敲击**
```gdscript
条件：心率>100时
效果：
- 播放墙内敲击声（3次）
- 心率+12
- 摄像机轻微震动
```

#### **事件3：广播异常**
```gdscript
条件：探索到3个物品后
效果：
- 播放扭曲的地铁广播（听不清内容）
- 心率+10
- 灯光剧烈闪烁1秒
```

---

### 2.2 音效层次丰富

#### **环境音效循环**
```gdscript
- 远处水滴声（每10-20秒）
- 换气扇转动声（持续低音）
- 偶尔的电流声（灯光闪烁时）
- 远处模糊的人声（若隐若现）
```

#### **互动音效反馈**
```gdscript
- 调查物品：轻微的"拾取"音效
- 移动时：空旷的脚步回音（已有，增强混响）
- 心率到达阈值：呼吸声加重
```

---

### 2.3 视觉细节提升

#### **开场镜头序列**
```gdscript
场景加载后：
1. 画面从纯黑淡入（2秒）
2. 摄像机从低角度缓慢抬起（3秒）
3. 聚焦地面积水倒影（2秒）
4. 灯光闪烁一次
5. 玩家获得控制权

实现：用动画播放器控制摄像机
```

#### **心率后处理效果**
```gdscript
当心率>120时：
- 画面边缘轻微扭曲（HeartRatePostEffects已有）
- 画面颜色饱和度降低
- 轻微的色差分离
```

#### **墙壁细节贴图**
```gdscript
在场景中添加：
- 褪色标语贴纸（材质球）
- 水渍材质（渐变）
- 墙皮剥落效果（法线贴图）
```

---

## 🚀 优先级3：进阶体验（5+小时）

### 3.1 陌生人行为系统

#### **视线跟踪**
```gdscript
陌生人会"感知"玩家位置：
- 玩家靠近时：头部缓慢转向玩家
- 玩家远离时：恢复低头状态
- 对话前：偶尔抬头看向玩家（每30秒）
```

#### **对话中的肢体语言**
```gdscript
在关键对话时：
- "我是卸下包袱的你" → 缓慢起身
- "戴上面具" → 凑近玩家（摄像机拉近）
- 对话结束 → 消失在黑暗中（淡出）
```

---

### 3.2 动态难度调整

根据玩家行为调整恐怖强度：

```gdscript
# 追踪玩家数据
- 探索速度（快速探索 vs 缓慢探索）
- 心率管理（频繁深呼吸 vs 忽略心率）
- 注视敏感度（经常触发注视 vs 避免注视）

# 调整策略
探索快的玩家 → 增加黑暗事件频率
心率管理好的玩家 → 增加心率压力
避免注视的玩家 → 强制触发某些注视事件
```

---

### 3.3 隐藏收集要素

#### **记忆碎片**
```gdscript
在场景中隐藏3-5个"记忆碎片"：
- 撕碎的照片（拼图玩法）
- 破损的日记页
- 小时候的玩具

效果：
- 收集后显示额外的心理独白
- 影响面具完整度
- 解锁隐藏结局线索
```

---

## 📝 实现优先级建议

### 第一批（推荐立即实现）
1. ✅ **添加4个新互动物品**（标语、积水、长椅、垃圾桶）
2. ✅ **启用环境渐变系统**（5阶段）
3. ✅ **陌生人注视效果**

**预计时间：** 1-2小时
**效果提升：** ⭐⭐⭐⭐⭐

---

### 第二批（增强氛围）
1. ⏳ **墙壁水渍注视效果**
2. ⏳ **3个黑暗事件**（脚步声、敲击、广播）
3. ⏳ **环境音效循环**

**预计时间：** 2-3小时
**效果提升：** ⭐⭐⭐⭐

---

### 第三批（可选扩展）
1. ⏳ 开场镜头序列
2. ⏳ 陌生人行为系统
3. ⏳ 隐藏收集要素

**预计时间：** 5+小时
**效果提升：** ⭐⭐⭐

---

## 🎯 快速原型代码

我可以立即帮你实现**第一批**内容，包括：

### 创建新互动物品脚本
```gdscript
# SimpleInteractable.gd
extends StaticBody3D
class_name SimpleInteractable

@export var interact_hint := "按 [E] 调查"
@export var dialogue_text := ""
@export var heart_rate_increase := 5.0
@export var trigger_env_progress := false
@export var play_sfx := ""

var has_interacted := false

func interact():
    if has_interacted:
        return
    has_interacted = true
    
    # 显示独白
    DialogueManager.show_text(dialogue_text)
    
    # 心率增加
    HeartRateSystem.increase_heart_rate(heart_rate_increase)
    
    # 环境进度
    if trigger_env_progress:
        EnvironmentProgressSystem.on_item_investigated()
    
    # 音效
    if play_sfx:
        AudioManager.play_sfx(play_sfx)
```

### 添加到场景
只需在Godot编辑器中：
1. 添加StaticBody3D节点
2. 添加CollisionShape3D
3. 添加MeshInstance3D（或导入模型）
4. 附加 `SimpleInteractable.gd` 脚本
5. 设置导出变量

---

## 💡 设计原则

遵循你的恐怖游戏设计理念：

1. **"少即是多"** - 不要过度堆砌恐怖元素
2. **渐进式压迫** - 从舒缓到紧张，有节奏感
3. **留白与想象** - 让玩家自己脑补恐怖
4. **环境叙事** - 通过物品和场景讲故事
5. **系统联动** - 心率、注视、环境三者互相影响

---

## 🎮 测试建议

每次添加新内容后：
1. 单独测试新物品/系统
2. 完整流程测试（从头玩到尾）
3. 调整数值（心率增加量、触发条件）
4. 平衡恐怖节奏（避免疲劳）

---

**你想从哪一批开始？我可以立即帮你实现代码！**

